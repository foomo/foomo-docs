"use strict";(self.webpackChunkfoomo=self.webpackChunkfoomo||[]).push([[3098],{3337:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>i,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>c,toc:()=>a});var t=n(5893),o=n(3905);const s={},l="Protocol",c={id:"projects/gotsrpc/protocol",title:"Protocol",description:"A gotsrpc method call is a http POST of an array of arguments to http(s)://host/path/to/service/endpoint/, that will return an array of return values. By default JSON is used for serialization.",source:"@site/docs/projects/gotsrpc/protocol.md",sourceDirName:"projects/gotsrpc",slug:"/projects/gotsrpc/protocol",permalink:"/docs/projects/gotsrpc/protocol",draft:!1,unlisted:!1,editUrl:"https://github.com/foomo/foomo-docs/tree/main/foomo/docs/projects/gotsrpc/protocol.md",tags:[],version:"current",frontMatter:{},sidebar:"projectsSidebar",previous:{title:"Playground",permalink:"/docs/projects/gotsrpc/playground/playground"},next:{title:"keel",permalink:"/docs/projects/keel/"}},i={},a=[{value:"HTTP status codes",id:"http-status-codes",level:2},{value:"Encoding / Marshalling",id:"encoding--marshalling",level:2},{value:"Curl example call to a running playground server",id:"curl-example-call-to-a-running-playground-server",level:2}];function d(e){const r={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.ah)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.h1,{id:"protocol",children:"Protocol"}),"\n",(0,t.jsxs)(r.p,{children:["A gotsrpc method call is a ",(0,t.jsx)(r.strong,{children:"http POST"})," of an ",(0,t.jsx)(r.strong,{children:"array of arguments"})," to ",(0,t.jsx)(r.code,{children:"http(s)://host/path/to/service/endpoint/<Method>"}),", that will return an ",(0,t.jsx)(r.strong,{children:"array of return values"}),". By default JSON is used for serialization."]}),"\n",(0,t.jsx)(r.p,{children:"Gotsrpc calls are not RESTful, but access to the underlying http requests and responses is possible. This is usually used for header access."}),"\n",(0,t.jsx)(r.h2,{id:"http-status-codes",children:"HTTP status codes"}),"\n",(0,t.jsx)(r.p,{children:"The response status code is"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"200 for all responses (including the ones with business logic errors)"}),"\n",(0,t.jsx)(r.li,{children:"500 when the go code, that implements the service interface panics"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"encoding--marshalling",children:"Encoding / Marshalling"}),"\n",(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.code,{children:"gotsrpc"})," supports"]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.a,{href:"https://www.json.org/",children:"JSON"})," (default)"]}),"\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.a,{href:"https://msgpack.org/",children:"MessagePack"})}),"\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.a,{href:"https://pkg.go.dev/encoding/gob",children:"gob"})}),"\n"]}),"\n",(0,t.jsxs)(r.admonition,{type:"note",children:[(0,t.jsxs)(r.p,{children:[(0,t.jsx)(r.strong,{children:"gotsrpc service proxies are not using streaming encoders or decoders"}),":"]}),(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"incoming data will be read completely from the request body"}),"\n",(0,t.jsx)(r.li,{children:"decoding / unmarshalling is not streaming (for all encodings)"}),"\n",(0,t.jsx)(r.li,{children:"return values will be encoded / marshalled in the same manner"}),"\n",(0,t.jsx)(r.li,{children:"the response is streamed"}),"\n"]}),(0,t.jsxs)(r.p,{children:["Thus you should ",(0,t.jsx)(r.strong,{children:"use paging, when transferring a lot of data"}),"."]})]}),"\n",(0,t.jsx)(r.h2,{id:"curl-example-call-to-a-running-playground-server",children:"Curl example call to a running playground server"}),"\n",(0,t.jsx)(r.p,{children:"A curl call tells more than a thousand words:"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:'curl -v --data-raw \'["Visitor"]\' http://localhost:8080/services/helloworld/Hello\n# > POST /services/helloworld/Hello HTTP/1.1\n# > Host: localhost:8080\n# >\n# < HTTP/1.1 200 OK\n# < Content-Type: application/json; charset=utf-8\n# <\n# ["Hello Visitor"]\n'})}),"\n",(0,t.jsxs)(r.p,{children:["When debugging and inspecting from the command line the ",(0,t.jsx)(r.code,{children:"fx"})," command is very helpful ",(0,t.jsx)(r.a,{href:"https://github.com/antonmedv/fx",children:"https://github.com/antonmedv/fx"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-shell",children:"curl -v --data-raw '[\"Visitor\"]' http://localhost:8080/services/helloworld/Hello | fx\n# starts fx which will read the server response from stdin\n# and provide a nice interactive json viewer\n"})})]})}function p(e={}){const{wrapper:r}={...(0,o.ah)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},3905:(e,r,n)=>{n.d(r,{ah:()=>a});var t=n(7294);function o(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function s(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function l(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?s(Object(n),!0).forEach((function(r){o(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function c(e,r){if(null==e)return{};var n,t,o=function(e,r){if(null==e)return{};var n,t,o={},s=Object.keys(e);for(t=0;t<s.length;t++)n=s[t],r.indexOf(n)>=0||(o[n]=e[n]);return o}(e,r);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)n=s[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=t.createContext({}),a=function(e){var r=t.useContext(i),n=r;return e&&(n="function"==typeof e?e(r):l(l({},r),e)),n},d={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},p=t.forwardRef((function(e,r){var n=e.components,o=e.mdxType,s=e.originalType,i=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),h=a(n),u=o,g=h["".concat(i,".").concat(u)]||h[u]||d[u]||s;return n?t.createElement(g,l(l({ref:r},p),{},{components:n})):t.createElement(g,l({ref:r},p))}));p.displayName="MDXCreateElement"}}]);