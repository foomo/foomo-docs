"use strict";(self.webpackChunkfoomo=self.webpackChunkfoomo||[]).push([[6660],{7475:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>c,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var o=n(5893),i=n(3905);const r={sidebar_label:"Spot Instance Node Pools"},s="Spot Instance Node Pools",a={id:"devops/kubernetes/spot-instance-node-pools",title:"Spot Instance Node Pools",description:"Setting up spot instance node pools is a great way to save money on stateless applications",source:"@site/docs/devops/kubernetes/spot-instance-node-pools.md",sourceDirName:"devops/kubernetes",slug:"/devops/kubernetes/spot-instance-node-pools",permalink:"/docs/devops/kubernetes/spot-instance-node-pools",draft:!1,unlisted:!1,editUrl:"https://github.com/foomo/foomo-docs/tree/main/foomo/docs/devops/kubernetes/spot-instance-node-pools.md",tags:[],version:"current",frontMatter:{sidebar_label:"Spot Instance Node Pools"},sidebar:"devopsSidebar",previous:{title:"Devops Guide",permalink:"/docs/devops/"},next:{title:"k8s",permalink:"/docs/devops/k8s"}},p={},d=[{value:"Setting Up Node Taints",id:"setting-up-node-taints",level:2},{value:"Setting Up Pod Toleration",id:"setting-up-pod-toleration",level:2},{value:"Pod Toleration",id:"pod-toleration",level:3},{value:"DaemonSet Toleration",id:"daemonset-toleration",level:3},{value:"Setting Up Pod Disruption Budgets",id:"setting-up-pod-disruption-budgets",level:2},{value:"Setting Up Termination Handling",id:"setting-up-termination-handling",level:2},{value:"Setting Up K8s Cron Shutdown Cleanup",id:"setting-up-k8s-cron-shutdown-cleanup",level:2}];function l(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,i.ah)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h1,{id:"spot-instance-node-pools",children:"Spot Instance Node Pools"}),"\n",(0,o.jsx)(t.p,{children:"Setting up spot instance node pools is a great way to save money on stateless applications"}),"\n",(0,o.jsx)(t.h2,{id:"setting-up-node-taints",children:"Setting Up Node Taints"}),"\n",(0,o.jsx)(t.h2,{id:"setting-up-pod-toleration",children:"Setting Up Pod Toleration"}),"\n",(0,o.jsx)(t.h3,{id:"pod-toleration",children:"Pod Toleration"}),"\n",(0,o.jsx)(t.h3,{id:"daemonset-toleration",children:"DaemonSet Toleration"}),"\n",(0,o.jsx)(t.p,{children:"Don't forget to set the daemonset tolerations"}),"\n",(0,o.jsx)(t.h2,{id:"setting-up-pod-disruption-budgets",children:"Setting Up Pod Disruption Budgets"}),"\n",(0,o.jsx)(t.p,{children:"Setting up a pod disruption budget is important due to erratic node shutdown possibility.\nWhat could happen is that nodes that are hosting the applications start terminating, and our application becomes\nunresponsive until the application is re-located to another node.\nTo avoid that situation, for the instances we need to configure pod disruption budget on our helm deployments."}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-yaml",children:"apiVersion: policy/v1\nkind: PodDisruptionBudget\nmetadata:\n  name: application-name\nspec:\n  maxAvailable: 50%\n  selector:\n    matchLabels:\n      app: application-name\n\n"})}),"\n",(0,o.jsxs)(t.p,{children:["For more details check out ",(0,o.jsx)(t.a,{href:"https://kubernetes.io/docs/tasks/run-application/configure-pdb/",children:"here"})]}),"\n",(0,o.jsx)(t.h2,{id:"setting-up-termination-handling",children:"Setting Up Termination Handling"}),"\n",(0,o.jsx)(t.h2,{id:"setting-up-k8s-cron-shutdown-cleanup",children:"Setting Up K8s Cron Shutdown Cleanup"})]})}function c(e={}){const{wrapper:t}={...(0,i.ah)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},3905:(e,t,n)=>{n.d(t,{ah:()=>d});var o=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,o,i=function(e,t){if(null==e)return{};var n,o,i={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=o.createContext({}),d=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},l={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,p=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),u=d(n),h=i,g=u["".concat(p,".").concat(h)]||u[h]||l[h]||r;return n?o.createElement(g,s(s({ref:t},c),{},{components:n})):o.createElement(g,s({ref:t},c))}));c.displayName="MDXCreateElement"}}]);