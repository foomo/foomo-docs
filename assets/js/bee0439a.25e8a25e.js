"use strict";(self.webpackChunkfoomo=self.webpackChunkfoomo||[]).push([[3429],{7873:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>a,toc:()=>u});var o=t(5893),r=t(3905),l=t(4562);const s={Title:"Goroutines and Channels",position:9,tags:["Go Basics"]},i="Go Routines and Channels",a={id:"backend/go-by-example/goroutines-and-channels",title:"Go Routines and Channels",description:"Go Routines",source:"@site/docs/backend/go-by-example/goroutines-and-channels.mdx",sourceDirName:"backend/go-by-example",slug:"/backend/go-by-example/goroutines-and-channels",permalink:"/docs/backend/go-by-example/goroutines-and-channels",draft:!1,unlisted:!1,editUrl:"https://github.com/foomo/foomo-docs/tree/main/foomo/docs/backend/go-by-example/goroutines-and-channels.mdx",tags:[{label:"Go Basics",permalink:"/docs/tags/go-basics"}],version:"current",frontMatter:{Title:"Goroutines and Channels",position:9,tags:["Go Basics"]},sidebar:"backendSidebar",previous:{title:"Files",permalink:"/docs/backend/go-by-example/files"},next:{title:"HTTP Client and Server",permalink:"/docs/backend/go-by-example/http"}},c={},u=[{value:"Go Routines",id:"go-routines",level:2},{value:"Channels",id:"channels",level:2},{value:"Unbuffered Channels",id:"unbuffered-channels",level:3},{value:"Buffered Channels",id:"buffered-channels",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.ah)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"go-routines-and-channels",children:"Go Routines and Channels"}),"\n",(0,o.jsx)(n.h2,{id:"go-routines",children:"Go Routines"}),"\n",(0,o.jsxs)(n.p,{children:["Go routines are go's mechanism to run code concurrently.\nTo create a goroutine we use the keyword ",(0,o.jsx)(n.code,{children:"go"})," followed by a function invocation.\nWhen you fork off a function by adding the ",(0,o.jsx)(n.code,{children:"go"})," keyword before it, it will run asynchronous. So it might be the case that your main function returns before the routine is done executing"]}),"\n",(0,o.jsx)(l.X,{id:"3Utx0iDshm8",proportion:1.6}),"\n",(0,o.jsx)(n.p,{children:"If you run this example you see that sometimes the statements in the go routines are printed out but other times they are not."}),"\n",(0,o.jsx)(n.p,{children:"Go follows a fork-join concurrency model. Go routines are forked off the main function and the main function will continue to run.\nIn go you are responsible for implementing the join point. In the example we saw earlier we did not implement a join point. That means\nwe did not sync our go routines up with the main function and therefore a lot of times you did not see our statements being printed out."}),"\n",(0,o.jsx)(n.h2,{id:"channels",children:"Channels"}),"\n",(0,o.jsx)(n.p,{children:"Typically you will use a channel to communicate between go routines. We can have go routines reference the same place in memory\nwhere a channel resides to be able to communicate with each other. This is a common way to implement a join point."}),"\n",(0,o.jsx)(n.p,{children:"A channel follows a First-In-First-Out (FIFO) structure. So the information you first write to the channel will be the first information to be read out from the channel.\nSince the main function is a go routine as well it can also communicate with its child go routines through channels."}),"\n",(0,o.jsx)(n.h3,{id:"unbuffered-channels",children:"Unbuffered Channels"}),"\n",(0,o.jsx)(n.p,{children:"To make an unbuffered go channel call make with chan and specify the type of channel you want."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:"func main() {\n    myChannel := make(chan string) // unbuffered channel of type string\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["To specify which function is writing and which function is reading from the channel we use arrows: ",(0,o.jsx)(n.code,{children:"<-"})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'func main() {\n    myChannel := make(chan string) // unbuffered channel of type string\n\n    go func() {\n        myChannel <- "I am always being printed now" // write to channel\n    }()\n\n    data := <- myChannel // read from the channel and store it in data variable\n    fmt.Println(data)\n}\n'})}),"\n",(0,o.jsx)(n.p,{children:"Unbuffered channels only allow go routines to communicate synchronously. This is because the go routine that sends the data to the unbuffered channel will\ngo into a waiting state once it has sent the data, until this data is read by the receiving go routine.\nSo until the data is read of the channel this go routine is blocked."}),"\n",(0,o.jsx)(n.h3,{id:"buffered-channels",children:"Buffered Channels"}),"\n",(0,o.jsx)(n.p,{children:"You can set a limit on the capacity of a channel by passing the limit to the make function:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:"func main() {\n    myChannel := make(chan string, 5)\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"To demonstrate how an unbuffered channel only allows for synchronous communication consider the following example:"}),"\n",(0,o.jsx)(l.X,{id:"0Vm7FZuDWqs",proportion:1.6}),"\n",(0,o.jsx)(n.p,{children:"You see that even though we made both go routines wait when the channel was read, the go routine using the buffered channel printed out all of the statements at once.\nAnd the go routine using the unbuffered channel had to wait each time until the channel was read out to be able to continue singing the greatest song of all time."})]})}function h(e={}){const{wrapper:n}={...(0,r.ah)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},4562:(e,n,t)=>{t.d(n,{X:()=>b});var o=t(7294),r={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},l=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],s=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],i=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],a="undefined"!=typeof window&&void 0!==window.document?window.document:{},c="fullscreenEnabled"in a&&Object.keys(r)||l[0]in a&&l||s[0]in a&&s||i[0]in a&&i||[];const u={requestFullscreen:function(e){return e[c[r.requestFullscreen]]()},requestFullscreenFunction:function(e){return e[c[r.requestFullscreen]]},get exitFullscreen(){return a[c[r.exitFullscreen]].bind(a)},get fullscreenPseudoClass(){return":"+c[r.fullscreen]},addEventListener:function(e,n,t){return a.addEventListener(c[r[e]],n,t)},removeEventListener:function(e,n,t){return a.removeEventListener(c[r[e]],n,t)},get fullscreenEnabled(){return Boolean(a[c[r.fullscreenEnabled]])},set fullscreenEnabled(e){},get fullscreenElement(){return a[c[r.fullscreenElement]]},set fullscreenElement(e){},get onfullscreenchange(){return a[("on"+c[r.fullscreenchange]).toLowerCase()]},set onfullscreenchange(e){return a[("on"+c[r.fullscreenchange]).toLowerCase()]=e},get onfullscreenerror(){return a[("on"+c[r.fullscreenerror]).toLowerCase()]},set onfullscreenerror(e){return a[("on"+c[r.fullscreenerror]).toLowerCase()]=e}};var d=function(e){var n=e.handle,t=e.onChange,r=e.children,l=e.className,s=[];return l&&s.push(l),s.push("fullscreen"),n.active&&s.push("fullscreen-enabled"),(0,o.useEffect)((function(){t&&t(n.active,n)}),[n.active]),o.createElement("div",{className:s.join(" "),ref:n.node,style:n.active?{height:"100%",width:"100%"}:void 0},r)},h=t(4991),f=t(9030),m=t(7087),g=t(9960),p=t(5893);const b=e=>{const[n,t]=(0,o.useState)(!1),[r,l]=(0,o.useState)(""),s=function(){var e=(0,o.useState)(!1),n=e[0],t=e[1],r=(0,o.useRef)(null);(0,o.useEffect)((function(){var e=function(){t(u.fullscreenElement===r.current)};return u.addEventListener("fullscreenchange",e),function(){return u.removeEventListener("fullscreenchange",e)}}),[]);var l=(0,o.useCallback)((function(){return u.fullscreenElement?u.exitFullscreen().then((function(){return u.requestFullscreen(r.current)})):r.current?u.requestFullscreen(r.current):void 0}),[]),s=(0,o.useCallback)((function(){return u.fullscreenElement===r.current?u.exitFullscreen():Promise.resolve()}),[]);return(0,o.useMemo)((function(){return{active:n,enter:l,exit:s,node:r}}),[n,l,s])}();(0,o.useEffect)((()=>{""==r&&""!==e.id&&fetch("https://docs.bestbytes.com/services/playground?id="+e.id,{mode:"cors"}).then((e=>e.text().then((e=>l(e))))).catch((e=>l("can not load source yet")))}),[r]);const i="https://goplay.tools/snippet/"+e.id;return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsxs)("div",{style:{paddingBottom:"1rem",width:"100%"},children:[n?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("button",{className:"button button--primary",onClick:e=>{t(!1)},children:"close playground"})," ",(0,p.jsx)("button",{className:"button button--primary"+(n?"":" disabled"),onClick:e=>{s.enter()},children:"fullscreen"})," "]}):(0,p.jsx)("button",{className:"button button--primary",onClick:e=>{t(!0)},children:"open playground"})," ",(0,p.jsxs)(g.Z,{href:i,children:["go to ",i]})]}),!n&&(0,p.jsx)(m.ZP,{...m.lG,code:r,language:"go",children:e=>{let{className:n,style:t,tokens:o,getLineProps:l,getTokenProps:s}=e;return(0,p.jsxs)("pre",{className:n,style:t,children:[""==r?"... loading sources":"",o.map(((e,n)=>(0,p.jsx)("div",{...l({line:e,key:n}),children:e.map(((e,n)=>(0,p.jsx)("span",{...s({token:e,key:n})})))})))]})}}),(0,p.jsx)("div",{style:{display:n?"block":"none"},children:(0,p.jsx)(f.k,{topic:"load external go playground, with all it\xb4s potentially evil cookies coming from https://goplay.tools",id:"goPlaygroundIsCool",children:(0,p.jsx)("div",{children:(0,p.jsx)(d,{handle:s,children:(0,p.jsx)(h.h,{src:i,proportion:e.proportion})})})})})]})}},4991:(e,n,t)=>{t.d(n,{h:()=>r});t(7294);var o=t(5893);const r=e=>{let{proportion:n,src:t,style:r}=e;return n||(n=4/3),r&&(r={}),(0,o.jsx)("div",{style:{width:"100%",height:0,paddingTop:100/n+"%",position:"relative",float:"left",...r},children:(0,o.jsx)("iframe",{style:{width:"100%",height:"100%",display:"block",position:"absolute",top:0,left:0},src:t,frameBorder:"0",scrolling:"no",allowFullScreen:!0})})}},9030:(e,n,t)=>{t.d(n,{k:()=>s});var o=t(7294),r=t(5893);const l="undefined"==typeof localStorage,s=e=>{const[n,t]=(0,o.useState)((s=e.id,"undefined"!=typeof localStorage&&localStorage.getItem(s)));var s;return(0,o.useEffect)((()=>{console.log("well it is cool",e.id,{isCool:n,SSR:l})}),[n,l]),n?e.children:(0,r.jsx)("div",{children:(0,r.jsx)("button",{className:"button button--lg button--secondary",onClick:n=>{localStorage.setItem(e.id,"yes"),t(!0)},children:e.topic})})}}}]);